==============================================================================
                      文档生成Agent使用说明
==============================================================================

【功能概述】
DocumentationAgent（文档生成助手）是一个专门用于分析代码项目并生成技术文档的智能体。

【核心能力】
1. 架构分析 - 理解项目整体架构设计，识别主要模块及其职责
2. 数据流分析 - 分析系统内部的数据流向和处理过程
3. 功能交互识别 - 识别各功能模块间的调用关系和交互方式
4. 用户交互分析 - 分析系统的用户界面和交互流程（如有前端）
5. 模块关系映射 - 梳理模块间的依赖关系和接口连接

【文档生成特点】
- 生成结构化的Markdown格式文档
- 使用Mermaid图表语法描述架构、流程和关系
- 在对话中直接输出文档内容（不自动创建文件）
- 文档包含清晰的标题层级和代码引用

==============================================================================
【使用方法】
==============================================================================

方法1: 启动服务器后通过前端使用
------------------------------
1. 启动服务器:
   cd ai_chat/backend
   python run_server.py

2. 通过WebSocket指定agent_name:
   {
     "type": "message",
     "content": "请生成项目架构文档",
     "mode": "agent",
     "agent_name": "文档生成助手"
   }

方法2: 使用测试脚本
------------------------------
1. 自动测试（运行预设的文档生成任务）:
   cd test
   python test_documentation_agent.py

2. 交互模式（自由对话）:
   cd test
   python test_documentation_agent.py interactive

==============================================================================
【典型使用场景】
==============================================================================

场景1: 生成架构文档
------------------------------
问题: "请为这个AI聊天项目生成一份架构设计文档，包含整体架构、主要模块和技术栈的说明"

Agent行为:
1. 调用 analyze_project_structure 分析项目结构
2. 调用 find_files 找到关键配置和入口文件
3. 调用 search_code 查找核心类和模块定义
4. 调用 read_file 深入理解关键实现
5. 生成包含Mermaid架构图的Markdown文档

场景2: 生成模块关系文档
------------------------------
问题: "请分析并生成Agent系统的模块关系文档，要包含各Agent的职责和它们之间的关系，最好用Mermaid图表描述"

Agent行为:
1. 调用 find_files 找到所有Agent文件
2. 调用 analyze_file 分析各Agent结构
3. 调用 search_code 查找Agent间的调用关系
4. 生成包含类图或关系图的文档

场景3: 生成数据流文档
------------------------------
问题: "请生成前后端数据交互流程文档，包括WebSocket通信机制和数据流向"

Agent行为:
1. 调用 search_code 查找WebSocket相关代码
2. 调用 read_file 理解通信机制
3. 追踪数据在系统中的流动
4. 生成包含序列图的数据流文档

场景4: 生成API文档
------------------------------
问题: "请生成工具系统的API文档，说明每个工具的功能、参数和使用方式"

Agent行为:
1. 调用 find_files 查找所有工具文件
2. 调用 analyze_file 提取工具定义
3. 调用 read_file 理解工具实现
4. 生成API文档，包含参数说明和示例

==============================================================================
【提问技巧】
==============================================================================

✅ 好的提问方式：
- "请生成项目的整体架构文档"
- "请分析Agent模块并生成技术文档，包含Mermaid类图"
- "请生成前后端交互流程文档，使用序列图描述"
- "请分析工具系统的设计并生成文档"

❌ 不太好的提问：
- "写个文档"（太模糊，没有说明要什么文档）
- "分析代码"（应该明确要生成什么类型的文档）

💡 提问建议：
1. 明确说明要生成什么类型的文档（架构、API、流程等）
2. 指定要分析的模块或范围
3. 可以要求使用特定的图表类型（Mermaid图表）
4. 对于大型项目，可以分模块分别生成文档

==============================================================================
【生成的文档包含】
==============================================================================

标准文档结构：
1. 概述 - 项目简介和核心功能
2. 架构设计 - 整体架构和技术栈
3. 模块说明 - 各模块职责和功能
4. 数据流 - 数据流向和处理流程（可含Mermaid图）
5. 接口设计 - API和模块接口
6. 使用示例 - 如何使用和部署

Mermaid图表类型：
- graph TD/LR - 架构图、流程图
- sequenceDiagram - 交互序列图
- classDiagram - 类关系图
- stateDiagram-v2 - 状态图

==============================================================================
【Agent配置信息】
==============================================================================

Agent名称: 文档生成助手
Agent类型: documentation
最大迭代次数: 20（足够处理复杂文档生成）
可用工具:
  - analyze_project_structure（分析项目结构）
  - search_code（搜索代码）
  - find_files（查找文件）
  - analyze_file（分析文件结构）
  - read_file（读取文件内容）
  - list_directory（列出目录）

==============================================================================
【注意事项】
==============================================================================

1. 文档在对话中生成
   - Agent不会自动创建.md文件
   - 文档内容直接在对话中输出
   - 你需要复制内容后手动保存

2. 基于实际代码分析
   - Agent会使用工具实际分析代码
   - 不会凭空假设或编造内容
   - 引用的文件路径和代码都是真实存在的

3. 文档格式
   - 标准Markdown格式
   - 包含Mermaid图表语法
   - 可以直接复制到.md文件使用

4. 分析深度
   - 对于大型项目，建议分模块生成文档
   - 可以多次对话，逐步完善文档
   - Agent会记住对话历史，可以连续提问

==============================================================================
【示例对话】
==============================================================================

用户: "请为这个项目生成一份架构文档"

助手: [调用多个工具分析代码...]

# 项目架构文档

## 1. 概述
本项目是一个基于FastAPI和WebSocket的AI聊天应用...

## 2. 整体架构

```mermaid
graph TD
    A[前端 HTML/CSS/JS] -->|WebSocket| B[FastAPI后端]
    B --> C[Agent系统]
    B --> D[工具系统]
    B --> E[会话管理]
    C --> F[LLM客户端]
    D --> F
```

## 3. 主要模块
### 3.1 Backend
- agents/ - Agent系统实现
- tools/ - 工具集合
- chat/ - 会话和消息处理
...

[以此类推，生成完整文档]

==============================================================================
【故障排查】
==============================================================================

Q: Agent没有调用工具？
A: 检查问题是否明确，尝试更具体地描述需要什么文档

Q: 生成的文档不完整？
A: 可以继续追问"请继续"或"请补充XXX部分的说明"

Q: 需要调整文档格式？
A: 可以要求"请用表格形式展示"或"请详细展开XXX部分"

Q: 如何保存文档？
A: 复制对话中的Markdown内容，粘贴到.md文件中保存

==============================================================================

更多信息请查看：
- DocumentationAgent源码: ai_chat/backend/agents/documentation_agent.py
- 测试脚本: test/test_documentation_agent.py

祝使用愉快！
